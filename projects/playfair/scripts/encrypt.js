window.addEventListener("load",setupPage);function setupPage(){var a=document.getElementById("encButton");null!=a&&a.addEventListener("click",encrypt)}function strip(a){var d="",c;for(c in a){var g=a.charAt(c);-1==g.search(/\s|\W|\d/igm)&&(d+=g)}return d}
function fillMatrix(){for(var a=window.sessionStorage.getItem("kw"),d=Array(25),c=0,g=0,a=strip(a),a=a.toLowerCase();g<a.length;){var e=a.charAt(g);-1==d.indexOf(e)&&(d[c]=e,c++);g++}for(var b in"abcdefghijklmnopqrstuvwxyz")if(a="abcdefghijklmnopqrstuvwxyz".charAt(b),-2==d.indexOf(a)+d.indexOf(a.toUpperCase()))"i"!=a&&"I"!=a||-1!=d.indexOf("j")||-1!=d.indexOf("J")?"j"==a||"J"==a&&-1==d.indexOf("i")&&-1==d.indexOf("I")||(d[c]=a,c++):(d[c]=a,c++);return d}
function getDigrams(a){var d=0;a=a.toLowerCase();for(var c="",g=a.length,e,b,f=[];d<a.length;)e=c.length,b=a.charAt(d),0==e?c+=b:1==e?c.charAt(0)==b?(c+="x",d--):(c+=b,f.push(c),c=""):(f.push(c),c="",c+=b),0!=g%2&&d==a.length-1&&0!=c.length%2?(c+="x",f.push(c)):d==a.length-1&&0!=c.length&&(c=b+"x",f.push(c)),d++;return f}
function encrypt(){var a=fillMatrix(),d=strip(document.getElementById("textP").value),c=getDigrams(d),g=[],e="",b,f,h,k,l,m;if(""==d)alert("Please input a text to be encrypted.");else{for(d=0;d<c.length;d++){b=c[d][0];f=c[d][1];"j"==b?b="i":"j"==f&&(f="i");b=a.indexOf(b);f=a.indexOf(f);l=Math.min(b,f);m=Math.max(b,f);var n=l%5,p=m%5;h=Math.abs(b-f);k=h%5;if(0==k)20<=b?(e+=a[b-20],e+=a[f+5]):20<=f?(e+=a[b+5],e+=a[f-20]):(e+=a[b+5],e+=a[f+5]);else if(4>=h&&p>n)4==h?0==(m+1)%5&&(0==(b+1)%5?(e+=a[b-4],
e+=a[f+1]):0==(f+1)%5&&(e+=a[b+1],e+=a[f-4])):0==(b+1)%5?(e+=a[b-4],e+=a[f+1]):0==(f+1)%5?(e+=a[b+1],e+=a[f-4]):(e+=a[b+1],e+=a[f+1]);else{h=l;k=0;if(0==(l+1)%5||n>p)for(;0!=Math.abs(h-m)%5;)h--,k--;else for(;0!=Math.abs(h-m)%5;)h++,k++;b==l?(e+=a[b+k],e+=a[f-k]):(e+=a[b-k],e+=a[f+k])}g.push(e);e=""}document.getElementById("encT").innerHTML=g.toString().replace(/,/ig," ")}};
