window.addEventListener("load",loadPage);function loadPage(){document.getElementById("decButton").addEventListener("click",decrypt)}
function decrypt(){var d=strip(document.getElementById("textC").value),f=window.sessionStorage.getObj("dimension"),a=window.sessionStorage.getObj("km"),k=[],g,c=[],e=[];if(""==d)alert("Please input a text to be decrypted.");else if(2==f){d=getDigrams(d);f=a[0][0]*a[1][1]-a[0][1]*a[1][0];f=modInverse(f,26);d=getColumnVectors(d,2);c.push([a[1][1],-a[0][1]+26]);c.push([-a[1][0]+26,a[0][0]]);for(var b in c)e.push([c[b][0]*f%26,c[b][1]*f%26]);for(b in d)a=(e[0][0]*d[b][0]+e[0][1]*d[b][1])%26,g=(e[1][0]*
d[b][0]+e[1][1]*d[b][1])%26,k.push([a,g]);document.getElementById("decT").innerHTML=reverseSearch(k,2).toString().replace(/,/ig," ")}else{var d=getTrigraph(d),d=getColumnVectors(d,3),h,f=a[0][0]*(a[1][1]*a[2][2]-a[1][2]*a[2][1]);h=a[0][1]*(a[1][0]*a[2][2]-a[1][2]*a[2][0]);f=modInverse((f-h+a[0][2]*(a[1][0]*a[2][1]-a[1][1]*a[2][0]))%26,26);h=-(a[0][1]*a[2][2]-a[0][2]*a[2][1]);g=a[0][0]*a[2][2]-a[0][2]*a[2][0];var l=-(a[0][0]*a[2][1]-a[0][1]*a[2][0]),m=a[0][1]*a[1][2]-a[0][2]*a[1][1],n=-(a[0][0]*a[1][2]-
a[0][2]*a[1][0]),p=a[0][0]*a[1][1]-a[0][1]*a[1][0];c.push([a[1][1]*a[2][2]-a[1][2]*a[2][1],-(a[1][0]*a[2][2]-a[2][0]*a[1][2]),a[1][0]*a[2][1]-a[1][1]*a[2][0]]);c.push([h,g,l]);c.push([m,n,p]);for(b in c)c[b][0]=0>c[b][0]?c[b][0]%26+26:c[b][0]%26,c[b][1]=0>c[b][1]?c[b][1]%26+26:c[b][1]%26,c[b][2]=0>c[b][2]?c[b][2]%26+26:c[b][2]%26;for(b in c)a=f*c[b][0]%26,h=f*c[b][1]%26,g=f*c[b][2]%26,e.push([a,h,g]);for(b in d)a=(e[0][0]*d[b][0]+e[1][0]*d[b][1]+e[2][0]*d[b][2])%26,h=(e[0][1]*d[b][0]+e[1][1]*d[b][1]+
e[2][1]*d[b][2])%26,g=(e[0][2]*d[b][0]+e[1][2]*d[b][1]+e[2][2]*d[b][2])%26,k.push([a,h,g]);document.getElementById("decT").innerHTML=reverseSearch(k,3).toString().replace(/,/ig," ")}};
